# co-feeling-platform

## 概要

「心の色」やストレスレベルをもとにBGMミックスを自動生成し、リアルタイムでストリーミング配信するプラットフォーム。GeoDjangoによる地図連携や、感情データの可視化・分析もサポートします。

---

## 要件整理

### 1. Must（必須要件）

- **BGMミックス自動生成エンジン**  
    - Python（pydub/ffmpeg/soundfile/numpy等）で音源をミックス
    - サンプリングレート・チャンネル数の正規化フロー設計
- **ストリーミング配信機能**  
    - WebSocket/HLS/WebRTC等でリアルタイム再生
    - ストリーミングサーバ選定（NGINX RTMP/Kurento等）
- **JWT認証付きREST API（DRF）**  
    - 投稿取得/作成/更新/削除エンドポイント設計
    - ステータスコード・権限スコープ・トークンリフレッシュ/失効対応
- **GeoDjango＋PostGIS**  
    - SRID統一（WGS84推奨）、距離検索・インデックス運用
- **WebSocket（Channels）によるリアルタイム更新**  
    - 関心エリア単位のチャネル管理、Redis連携・スケール戦略
- **管理画面で辞書編集＋自動分類**  
    - Django Admin、辞書バージョン管理・履歴・感情スコア設計
- **日本地図上へのプロット＆ホットスポット表示**  
    - Leaflet.js/Mapbox GL JS推奨、色分け・統計的検出仕様化
- **スケーラビリティ**  
    - Kubernetes/ECS等でLB＋複数インスタンス構成、負荷試験計画

---

### 2. Should（推奨要件）

- **リアルタイム天気情報連携**  
    - OpenWeather API＋Redisキャッシュ
- **タイムライン／履歴表示**  
    - 無限スクロール・ページネーション
- **感情タグ細分類**  
    - 管理画面から動的追加
- **プロフィール機能**  
    - OAuth（Google/Twitter）またはメール＋パスワード
- **Redisキャッシュ**  
    - GeoDjangoクエリ/APIレスポンスキャッシュ

---

### 3. Could（任意要件）

- **セッション保持／スケーラビリティ設計**  
    - ユーザーごとにキャッシュ、API/ストリーミングサーバ分離
- **ワークフローのキューイング（Celery等）**  
    - 非同期タスク化、S3アップロード
- **ストレス推定の高度化**  
    - 自然言語解析・機械学習モデル組込
- **SNS連携**  
    - Twitter API v2ストリーミング
- **ヒートマップ以外の可視化**  
    - DBクラスター情報→GeoJSON
- **多言語対応**  
    - gettextベースローカライズ

---

### 4. Won’t（除外要件）

- ソーシャル／モバイルネイティブは現フェーズ除外
- 将来の外部シェア・Flutterアプリ化はロードマップに記載

---

## 次フェーズの検討ポイント

- **API仕様書**  
    - OpenAPI(Swagger)やGraphQL SDLで定義
- **インフラ／運用**  
    - 音声ファイル保存/CDN配信/監視（Prometheus＋Grafana）
- **UX／UI設計**  
    - 「心の色」選択画面、再生中ボリューム調整スライダー
- **テスト戦略**  
    - 単体（pytest）、統合（Playwright/Cypress）、A/Bテスト
- **運用／監視設計**  
    - ログ収集（ELK/Grafana Loki）、メトリクス、アラート
- **セキュリティ**  
    - レート制限、XSS/CSRF対策、セキュアヘッダー
- **データベース設計**  
    - 投稿/ユーザー/感情辞書/ホットスポット用テーブル、ER図作成

---

## 開発・運用のポイント

- Must/Should/Couldで段階的に実装
- 運用・品質・拡張性を意識した設計
- 追加で深掘りしたい項目があればIssue/Discussionでご相談ください
